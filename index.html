<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AkıllıMarket</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Akıllı alışveriş asistanınız">
    <meta name="theme-color" content="#6366F1">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="AkıllıMarket">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #6366F1;
            --primary-dark: #4F46E5;
            --secondary-color: #F59E0B;
            --accent-color: #10B981;
            --background-color: #F8FAFC;
            --background-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --text-color: #1E293B;
            --text-light: #64748B;
            --card-background: #FFFFFF;
            --border-color: #E2E8F0;
            --shadow: 0 10px 25px rgba(99, 102, 241, 0.1);
            --shadow-hover: 0 20px 40px rgba(99, 102, 241, 0.2);
        }

        [data-theme="dark"] {
            --primary-color: #818CF8;
            --primary-dark: #6366F1;
            --secondary-color: #FBBF24;
            --accent-color: #34D399;
            --background-color: #0F172A;
            --background-gradient: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 100%);
            --text-color: #F1F5F9;
            --text-light: #94A3B8;
            --card-background: #1E293B;
            --border-color: #334155;
            --shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--background-color);
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            color: var(--text-color);
            transition: all 0.4s ease;
            font-weight: 400;
            line-height: 1.6;
        }

        body.large-text {
            font-size: 1.3em !important;
        }

        body.large-text .card-title {
            font-size: 28px !important;
        }

        body.high-contrast {
            filter: contrast(200%) brightness(1.2) !important;
        }

        body.high-contrast .card {
            border: 3px solid var(--text-color) !important;
            box-shadow: 0 0 20px rgba(0,0,0,0.6) !important;
        }

        .app-container {
            max-width: 420px;
            margin: 0 auto;
            min-height: 100vh;
            background: var(--background-color);
        }

        /* Login */
        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: var(--background-gradient);
            color: white;
            padding: 20px;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 24px;
            background: rgba(255, 255, 255, 0.15);
            padding: 48px 36px;
            border-radius: 28px;
            backdrop-filter: blur(20px);
            width: 100%;
            max-width: 340px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        }

        .login-form h1 {
            font-size: 36px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
        }

        .login-form p {
            text-align: center;
            opacity: 0.9;
            font-weight: 400;
            margin-bottom: 20px;
            font-size: 16px;
        }

        .login-form input {
            padding: 18px 24px;
            border: none;
            border-radius: 18px;
            font-size: 16px;
            font-weight: 500;
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            font-family: 'Poppins', sans-serif;
        }

        .login-form button {
            padding: 18px;
            border: none;
            border-radius: 18px;
            font-size: 16px;
            font-weight: 600;
            background: linear-gradient(135deg, #6366F1 0%, #4F46E5 100%);
            color: white;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .login-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
        }

        /* Header */
        .app-header {
            background: var(--background-gradient);
            color: white;
            padding: 24px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
        }

        .app-header h1 {
            font-size: 26px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }

        .user-info button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 14px;
            cursor: pointer;
            font-weight: 500;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .user-info button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        /* Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 420px;
            background: var(--card-background);
            display: flex;
            justify-content: space-around;
            padding: 16px 0;
            border-top: 1px solid var(--border-color);
            box-shadow: 0 -10px 25px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(20px);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            padding: 10px 16px;
            border-radius: 16px;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 12px;
            color: var(--text-light);
        }

        .nav-item.active {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: 22px;
            transition: all 0.3s ease;
        }

        .nav-item.active .nav-icon {
            transform: scale(1.1);
        }

        /* Main Content */
        .main-content {
            padding: 24px 20px;
            padding-bottom: 120px;
            min-height: calc(100vh - 160px);
        }

        /* Cards */
        .card {
            background: var(--card-background);
            border-radius: 24px;
            padding: 28px;
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-2px);
        }

        .card-title {
            font-size: 22px;
            font-weight: 700;
            color: var(--text-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            letter-spacing: -0.3px;
        }

        /* Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: var(--background-gradient);
            color: white;
            padding: 24px 20px;
            border-radius: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            display: block;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
            font-weight: 500;
        }

        /* Input Groups */
        .input-group {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
        }

        .input-group input, .input-group select {
            flex: 1;
            padding: 18px 24px;
            border: 2px solid var(--border-color);
            border-radius: 18px;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: var(--card-background);
            color: var(--text-color);
            font-family: 'Poppins', sans-serif;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .two-column-input {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 16px;
            margin-bottom: 20px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            padding: 18px 28px;
            border-radius: 18px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color) 0%, #F59E0B 100%);
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 16px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 6px 15px rgba(245, 158, 11, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(245, 158, 11, 0.4);
        }

        /* Delete Button */
        .delete-btn {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%) !important;
            color: white !important;
            border: none !important;
            padding: 10px 14px !important;
            border-radius: 12px !important;
            cursor: pointer !important;
            font-size: 16px !important;
            transition: all 0.3s ease !important;
            min-width: 44px !important;
            z-index: 999 !important;
            position: relative !important;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3) !important;
        }

        .delete-btn:hover {
            background: linear-gradient(135deg, #DC2626 0%, #B91C1C 100%) !important;
            transform: translateY(-2px) scale(1.05) !important;
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4) !important;
        }

        /* AI Suggestions */
        .ai-suggestions {
            background: linear-gradient(135deg, #EEF2FF 0%, #F0F9FF 100%);
            padding: 24px;
            border-radius: 20px;
            border-left: 5px solid var(--primary-color);
            margin-bottom: 24px;
            animation: slideIn 0.5s ease-out;
        }

        /* AI Bot Response */
        .ai-bot-response {
            background: linear-gradient(135deg, #F3E8FF 0%, #EEF2FF 100%);
            padding: 24px;
            border-radius: 20px;
            border-left: 5px solid #A855F7;
            margin-bottom: 24px;
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-15px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Settings */
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-weight: 600;
            color: var(--text-color);
            font-size: 16px;
        }

        .setting-description {
            font-size: 14px;
            color: var(--text-light);
            margin-top: 4px;
        }

        .toggle-switch {
            position: relative;
            width: 56px;
            height: 28px;
            background: #CBD5E1;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch.active {
            background: var(--primary-color) !important;
        }

        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(28px);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 24px;
            right: 24px;
            background: var(--card-background);
            color: var(--text-color);
            padding: 18px 24px;
            border-radius: 16px;
            z-index: 1001;
            transform: translateX(400px);
            transition: all 0.4s ease;
            box-shadow: var(--shadow-hover);
            border: 1px solid var(--border-color);
            font-weight: 500;
            max-width: 320px;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Responsive */
        @media (max-width: 480px) {
            .two-column-input {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Notification -->
    <div id="notification" class="notification">
        <div id="notificationText"></div>
    </div>

    <div id="app"></div>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }

        // Global state
        let appState = {
            user: null,
            currentPage: 'home',
            shoppingList: JSON.parse(localStorage.getItem('akilliMarket_shoppingList') || '[]'),
            newItem: '',
            newQuantity: '1',
            newUnit: 'adet',
            aiQuery: '',
            aiSuggestions: [],
            aiBotResponse: '',
            settings: JSON.parse(localStorage.getItem('akilliMarket_settings') || '{"darkMode":false,"highContrast":false,"largeText":false}')
        };

        // AI Aşçı Yemek Veritabanı
        const chefMealDatabase = {
            'makarna': {
                ingredients: [
                    { name: 'makarna', quantity: '500g' },
                    { name: 'domates sosu', quantity: '1 adet' },
                    { name: 'parmesan peyniri', quantity: '100g' },
                    { name: 'zeytinyağı', quantity: '1 şişe' }
                ],
                response: "🍝 Makarna için gerekli malzemeler hazırlandı! Klasik bir İtalyan lezzeti için bu malzemeler yeterli."
            },
            'omlet': {
                ingredients: [
                    { name: 'yumurta', quantity: '6 adet' },
                    { name: 'süt', quantity: '1 litre' },
                    { name: 'peynir', quantity: '200g' },
                    { name: 'tereyağı', quantity: '250g' }
                ],
                response: "🍳 Mükemmel bir omlet için gerekli malzemeler! Protein açısından zengin ve doyurucu bir kahvaltı."
            },
            'salata': {
                ingredients: [
                    { name: 'marul', quantity: '1 adet' },
                    { name: 'domates', quantity: '500g' },
                    { name: 'salatalık', quantity: '3 adet' },
                    { name: 'zeytinyağı', quantity: '1 şişe' },
                    { name: 'limon', quantity: '2 adet' }
                ],
                response: "🥗 Taze ve sağlıklı salata malzemeleri! Vitamin açısından zengin bir öğün için ideal."
            },
            'çorba': {
                ingredients: [
                    { name: 'tavuk eti', quantity: '1 kg' },
                    { name: 'havuç', quantity: '500g' },
                    { name: 'soğan', quantity: '3 adet' },
                    { name: 'pirinç', quantity: '500g' },
                    { name: 'tuz', quantity: '1 paket' }
                ],
                response: "🍲 Besleyici tavuk çorbası malzemeleri! Hasta olduğunuzda veya soğuk havalarda ideal."
            },
            'pizza': {
                ingredients: [
                    { name: 'pizza hamuru', quantity: '2 adet' },
                    { name: 'domates sosu', quantity: '1 adet' },
                    { name: 'mozzarella peyniri', quantity: '300g' },
                    { name: 'sucuk', quantity: '200g' },
                    { name: 'mantar', quantity: '250g' }
                ],
                response: "🍕 Ev yapımı pizza malzemeleri! Ailenizle birlikte eğlenceli bir yemek deneyimi."
            },
            'tavuklu pilav': {
                ingredients: [
                    { name: 'tavuk eti', quantity: '1 kg' },
                    { name: 'pirinç', quantity: '2 su bardağı' },
                    { name: 'soğan', quantity: '2 adet' },
                    { name: 'tereyağı', quantity: '100g' },
                    { name: 'tavuk suyu', quantity: '3 su bardağı' },
                    { name: 'tuz', quantity: '1 paket' },
                    { name: 'karabiber', quantity: '1 paket' }
                ],
                response: "🍚 Geleneksel tavuklu pilav malzemeleri! Türk mutfağının vazgeçilmez lezzeti."
            },
            'karnıyarık': {
                ingredients: [
                    { name: 'patlıcan', quantity: '6 adet' },
                    { name: 'kıyma', quantity: '500g' },
                    { name: 'soğan', quantity: '2 adet' },
                    { name: 'domates', quantity: '3 adet' },
                    { name: 'biber', quantity: '2 adet' },
                    { name: 'zeytinyağı', quantity: '1 şişe' },
                    { name: 'maydanoz', quantity: '1 demet' }
                ],
                response: "🍆 Enfes karnıyarık malzemeleri! Türk mutfağının en sevilen yemeklerinden biri."
            },
            'menemen': {
                ingredients: [
                    { name: 'yumurta', quantity: '4 adet' },
                    { name: 'domates', quantity: '3 adet' },
                    { name: 'biber', quantity: '2 adet' },
                    { name: 'soğan', quantity: '1 adet' },
                    { name: 'zeytinyağı', quantity: '1 şişe' },
                    { name: 'tuz', quantity: '1 paket' }
                ],
                response: "🍳 Lezzetli menemen malzemeleri! Türk kahvaltısının vazgeçilmez lezzeti."
            },
            'köfte': {
                ingredients: [
                    { name: 'kıyma', quantity: '500g' },
                    { name: 'soğan', quantity: '1 adet' },
                    { name: 'ekmek içi', quantity: '2 dilim' },
                    { name: 'yumurta', quantity: '1 adet' },
                    { name: 'maydanoz', quantity: '1 demet' },
                    { name: 'tuz', quantity: '1 paket' },
                    { name: 'karabiber', quantity: '1 paket' }
                ],
                response: "🥩 Ev yapımı köfte malzemeleri! Herkesin sevdiği klasik lezzet."
            },
            'mercimek çorbası': {
                ingredients: [
                    { name: 'kırmızı mercimek', quantity: '1 su bardağı' },
                    { name: 'soğan', quantity: '1 adet' },
                    { name: 'havuç', quantity: '1 adet' },
                    { name: 'patates', quantity: '1 adet' },
                    { name: 'tereyağı', quantity: '50g' },
                    { name: 'un', quantity: '1 yemek kaşığı' },
                    { name: 'tuz', quantity: '1 paket' }
                ],
                response: "🍲 Besleyici mercimek çorbası malzemeleri! Sağlıklı ve doyurucu bir çorba."
            },
            'döner': {
                ingredients: [
                    { name: 'tavuk eti', quantity: '1 kg' },
                    { name: 'lavash', quantity: '6 adet' },
                    { name: 'domates', quantity: '2 adet' },
                    { name: 'salatalık', quantity: '1 adet' },
                    { name: 'soğan', quantity: '1 adet' },
                    { name: 'marul', quantity: '1 adet' },
                    { name: 'sos', quantity: '2 adet' }
                ],
                response: "🌯 Ev yapımı döner malzemeleri! Sokak lezzetini evinizde yapın."
            },
            'mantı': {
                ingredients: [
                    { name: 'mantı', quantity: '500g' },
                    { name: 'kıyma', quantity: '300g' },
                    { name: 'yoğurt', quantity: '500g' },
                    { name: 'sarımsak', quantity: '3 diş' },
                    { name: 'tereyağı', quantity: '100g' },
                    { name: 'domates salçası', quantity: '1 kaşık' },
                    { name: 'nane', quantity: '1 demet' }
                ],
                response: "🥟 Geleneksel mantı malzemeleri! Türk mutfağının en özel lezzetlerinden."
            },
            'lahmacun': {
                ingredients: [
                    { name: 'lahmacun hamuru', quantity: '8 adet' },
                    { name: 'kıyma', quantity: '400g' },
                    { name: 'soğan', quantity: '2 adet' },
                    { name: 'domates', quantity: '2 adet' },
                    { name: 'maydanoz', quantity: '1 demet' },
                    { name: 'salça', quantity: '2 kaşık' },
                    { name: 'baharat', quantity: '1 paket' }
                ],
                response: "🫓 Enfes lahmacun malzemeleri! Türk mutfağının vazgeçilmez lezzeti."
            },
            'pide': {
                ingredients: [
                    { name: 'pide hamuru', quantity: '4 adet' },
                    { name: 'kaşar peyniri', quantity: '300g' },
                    { name: 'yumurta', quantity: '4 adet' },
                    { name: 'sucuk', quantity: '200g' },
                    { name: 'tereyağı', quantity: '100g' }
                ],
                response: "🥖 Lezzetli pide malzemeleri! Kahvaltı ve akşam yemeği için ideal."
            },
            'börek': {
                ingredients: [
                    { name: 'yufka', quantity: '1 paket' },
                    { name: 'beyaz peynir', quantity: '400g' },
                    { name: 'maydanoz', quantity: '1 demet' },
                    { name: 'yumurta', quantity: '3 adet' },
                    { name: 'süt', quantity: '1 su bardağı' },
                    { name: 'zeytinyağı', quantity: '1 şişe' }
                ],
                response: "🥧 Su böreği malzemeleri! Geleneksel Türk böreği için mükemmel."
            },
            'dolma': {
                ingredients: [
                    { name: 'yaprak', quantity: '1 paket' },
                    { name: 'pirinç', quantity: '1 su bardağı' },
                    { name: 'kıyma', quantity: '300g' },
                    { name: 'soğan', quantity: '2 adet' },
                    { name: 'dereotu', quantity: '1 demet' },
                    { name: 'zeytinyağı', quantity: '1 şişe' },
                    { name: 'limon', quantity: '3 adet' }
                ],
                response: "🍃 Geleneksel dolma malzemeleri! Özenle sarılmış lezzet."
            },
            'kebap': {
                ingredients: [
                    { name: 'kuzu eti', quantity: '1 kg' },
                    { name: 'soğan', quantity: '3 adet' },
                    { name: 'domates', quantity: '4 adet' },
                    { name: 'biber', quantity: '4 adet' },
                    { name: 'lavash', quantity: '8 adet' },
                    { name: 'sumak', quantity: '1 paket' }
                ],
                response: "🍖 Nefis kebap malzemeleri! Mangalda pişirilecek enfes lezzet."
            },
            'baklava': {
                ingredients: [
                    { name: 'baklava yufkası', quantity: '1 paket' },
                    { name: 'ceviz', quantity: '300g' },
                    { name: 'tereyağı', quantity: '200g' },
                    { name: 'şeker', quantity: '2 su bardağı' },
                    { name: 'su', quantity: '1.5 su bardağı' },
                    { name: 'limon suyu', quantity: '1 kaşık' }
                ],
                response: "🍯 Geleneksel baklava malzemeleri! Ev yapımı tatlı keyfi."
            },
            'künefe': {
                ingredients: [
                    { name: 'kadayıf', quantity: '500g' },
                    { name: 'tel peynir', quantity: '300g' },
                    { name: 'tereyağı', quantity: '150g' },
                    { name: 'şerbet', quantity: '2 su bardağı' },
                    { name: 'fıstık', quantity: '100g' }
                ],
                response: "🧀 Enfes künefe malzemeleri! Sıcak servis edilen muhteşem tatlı."
            },
            'sushi': {
                ingredients: [
                    { name: 'sushi pirinci', quantity: '2 su bardağı' },
                    { name: 'nori', quantity: '10 yaprak' },
                    { name: 'somon', quantity: '300g' },
                    { name: 'avokado', quantity: '2 adet' },
                    { name: 'salatalık', quantity: '1 adet' },
                    { name: 'wasabi', quantity: '1 tüp' },
                    { name: 'soya sosu', quantity: '1 şişe' }
                ],
                response: "🍣 Japon mutfağından sushi malzemeleri! Evde sushi yapma keyfi."
            },
            'ramen': {
                ingredients: [
                    { name: 'ramen noodle', quantity: '4 paket' },
                    { name: 'tavuk eti', quantity: '500g' },
                    { name: 'yumurta', quantity: '4 adet' },
                    { name: 'soğan', quantity: '2 adet' },
                    { name: 'sarımsak', quantity: '4 diş' },
                    { name: 'soya sosu', quantity: '1 şişe' },
                    { name: 'yeşil soğan', quantity: '1 demet' }
                ],
                response: "🍜 Sıcak ramen çorbası malzemeleri! Japon usulü besleyici çorba."
            },
            'tacos': {
                ingredients: [
                    { name: 'tortilla', quantity: '8 adet' },
                    { name: 'dana eti', quantity: '500g' },
                    { name: 'marul', quantity: '1 adet' },
                    { name: 'domates', quantity: '3 adet' },
                    { name: 'kaşar peyniri', quantity: '200g' },
                    { name: 'avokado', quantity: '2 adet' },
                    { name: 'limon', quantity: '2 adet' }
                ],
                response: "🌮 Meksika usulü tacos malzemeleri! Renkli ve lezzetli bir deneyim."
            },
            'paella': {
                ingredients: [
                    { name: 'bomba pirinci', quantity: '2 su bardağı' },
                    { name: 'tavuk eti', quantity: '500g' },
                    { name: 'karides', quantity: '300g' },
                    { name: 'midye', quantity: '200g' },
                    { name: 'safran', quantity: '1 paket' },
                    { name: 'domates', quantity: '2 adet' },
                    { name: 'biber', quantity: '2 adet' }
                ],
                response: "🥘 İspanyol mutfağından paella malzemeleri! Deniz ürünleri ile zengin lezzet."
            },
            'pad thai': {
                ingredients: [
                    { name: 'pirinç noodle', quantity: '400g' },
                    { name: 'karides', quantity: '300g' },
                    { name: 'yumurta', quantity: '3 adet' },
                    { name: 'fasulye filizi', quantity: '200g' },
                    { name: 'fıstık', quantity: '100g' },
                    { name: 'limon', quantity: '2 adet' },
                    { name: 'balık sosu', quantity: '1 şişe' }
                ],
                response: "🍤 Tayland mutfağından Pad Thai malzemeleri! Egzotik Asya lezzeti."
            }
        };

        // Ürün emoji belirleme fonksiyonu
        function getProductEmoji(item) {
            const emojiMap = {
                // Sebze & Meyve
                'domates': '🍅', 'salatalık': '🥒', 'elma': '🍎', 'muz': '🍌', 'patates': '🥔',
                'soğan': '🧅', 'marul': '🥬', 'limon': '🍋', 'havuç': '🥕', 'biber': '🌶️',
                'patlıcan': '🍆', 'kabak': '🥒', 'portakal': '🍊', 'üzüm': '🍇', 'çilek': '🍓',
                'kiraz': '🍒', 'armut': '🍐', 'brokoli': '🥦', 'mantar': '🍄', 'sarımsak': '🧄',
                'maydanoz': '🌿', 'nane': '🌿', 'dereotu': '🌿', 'yeşil soğan': '🌿',
                'erik': '🟣', 'kivi': '🥝', 'karpuz': '🍉', 'kavun': '🍈', 'şeftali': '🍑',
                'kayısı': '🍑', 'incir': '🟤', 'nar': '🔴', 'ananas': '🍍', 'mango': '🥭',
                'avokado': '🥑', 'hindistan cevizi': '🥥', 'fasulye': '🫘', 'bezelye': '🟢',
                'mısır': '🌽', 'bamya': '🟢', 'turp': '🔴', 'pancar': '🟣', 'lahana': '🥬',
                'karnabahar': '🥦', 'ispanak': '🥬', 'roka': '🥬', 'semizotu': '🌿',
                
                // Et & Süt
                'tavuk': '🐔', 'dana eti': '🥩', 'balık': '🐟', 'süt': '🥛', 'yoğurt': '🥛',
                'peynir': '🧀', 'yumurta': '🥚', 'tereyağı': '🧈', 'kıyma': '🥩', 'sosis': '🌭',
                'sucuk': '🌭', 'kaşar': '🧀', 'beyaz peynir': '🧀', 'tavuk eti': '🐔',
                'mozzarella peyniri': '🧀', 'parmesan peyniri': '🧀', 'tavuk suyu': '🍲',
                'kuzu eti': '🥩', 'karides': '🦐', 'midye': '🦪', 'somon': '🐟',
                'tel peynir': '🧀', 'kaşar peyniri': '🧀',
                
                // Temel Gıda
                'ekmek': '🍞', 'pirinç': '🍚', 'makarna': '🍝', 'un': '🌾', 'şeker': '🍯',
                'tuz': '🧂', 'zeytinyağı': '🫒', 'mercimek': '🌰', 'nohut': '🌰', 'bulgur': '🌾',
                'yulaf': '🌾', 'bal': '🍯', 'reçel': '🍯', 'çay': '🍵', 'kahve': '☕',
                'domates sosu': '🍅', 'pizza hamuru': '🍕', 'kırmızı mercimek': '🌰',
                'ekmek içi': '🍞', 'lavash': '🫓', 'mantı': '🥟', 'domates salçası': '🍅',
                'karabiber': '🌶️', 'sos': '🥫', 'salça': '🍅', 'baharat': '🌶️',
                'ayçiçek yağı': '🌻', 'mısır yağı': '🌽', 'susam yağı': '🌰', 'fındık yağı': '🌰',
                'quinoa': '🌾', 'chia tohumu': '🌰', 'çekirdek': '🌰', 'fındık': '🌰',
                'badem': '🌰', 'ceviz': '🌰', 'fıstık': '🥜', 'susam': '🌰',
                'yufka': '🫓', 'tortilla': '🌮', 'nori': '🟢', 'wasabi': '🟢',
                'soya sosu': '🥫', 'balık sosu': '🥫', 'ramen noodle': '🍜',
                'pirinç noodle': '🍜', 'sushi pirinci': '🍚', 'bomba pirinci': '🍚',
                'kadayıf': '🍯', 'baklava yufkası': '🍯', 'şerbet': '🍯',
                'safran': '🟡', 'sumak': '🔴', 'fasulye filizi': '🌱',
                'lahmacun hamuru': '🫓', 'pide hamuru': '🥖', 'yaprak': '🍃',
                
                // İçecekler
                'su': '💧', 'meyve suyu': '🧃', 'kola': '🥤', 'ayran': '🥛',
                'gazoz': '🥤', 'şarap': '🍷', 'bira': '🍺',
                
                // Temizlik
                'deterjan': '🧽', 'sabun': '🧼', 'şampuan': '🧴', 'diş macunu': '🦷',
                'çöp poşeti': '🗑️', 'tuvalet kağıdı': '🧻'
            };
            
            const itemLower = item.toLowerCase();
            
            if (emojiMap[itemLower]) {
                return emojiMap[itemLower];
            }
            
            for (const [keyword, emoji] of Object.entries(emojiMap)) {
                if (itemLower.includes(keyword) || keyword.includes(itemLower)) {
                    return emoji;
                }
            }
            
            return '🛒';
        }

        // Kategori belirleme fonksiyonu
        function categorizeItem(item) {
            const categories = {
                '🥬 Sebze & Meyve': [
                    'domates', 'salatalık', 'elma', 'muz', 'patates', 'soğan', 
                    'marul', 'limon', 'havuç', 'biber', 'patlıcan', 'kabak',
                    'portakal', 'üzüm', 'çilek', 'kiraz', 'armut', 'brokoli', 'mantar',
                    'sarımsak', 'maydanoz', 'nane', 'dereotu', 'yeşil soğan',
                    'erik', 'kivi', 'karpuz', 'kavun', 'şeftali', 'kayısı', 'incir',
                    'nar', 'ananas', 'mango', 'avokado', 'hindistan cevizi', 'fasulye',
                    'bezelye', 'mısır', 'bamya', 'turp', 'pancar', 'lahana',
                    'karnabahar', 'ispanak', 'roka', 'semizotu', 'fasulye filizi', 'yaprak'
                ],
                '🥩 Et & Süt': [
                    'tavuk', 'dana eti', 'kuzu eti', 'balık', 'süt', 'yoğurt', 
                    'peynir', 'yumurta', 'tereyağı', 'kıyma', 'sosis', 'sucuk',
                    'kaşar', 'beyaz peynir', 'krema', 'tavuk eti', 'mozzarella peyniri', 
                    'parmesan peyniri', 'tavuk suyu', 'karides', 'midye', 'somon',
                    'tel peynir', 'kaşar peyniri'
                ],
                '🍞 Temel Gıda': [
                    'ekmek', 'pirinç', 'makarna', 'un', 'şeker', 'tuz', 
                    'zeytinyağı', 'mercimek', 'nohut', 'bulgur', 'yulaf',
                    'bal', 'reçel', 'çay', 'kahve', 'domates sosu', 'pizza hamuru',
                    'kırmızı mercimek', 'ekmek içi', 'lavash', 'mantı', 'domates salçası',
                    'karabiber', 'sos', 'salça', 'baharat', 'ayçiçek yağı', 'mısır yağı',
                    'susam yağı', 'fındık yağı', 'quinoa', 'chia tohumu', 'çekirdek',
                    'fındık', 'badem', 'ceviz', 'fıstık', 'susam', 'yufka', 'tortilla',
                    'nori', 'wasabi', 'soya sosu', 'balık sosu', 'ramen noodle',
                    'pirinç noodle', 'sushi pirinci', 'bomba pirinci', 'kadayıf',
                    'baklava yufkası', 'şerbet', 'safran', 'sumak', 'lahmacun hamuru', 'pide hamuru'
                ],
                '💧 İçecekler': [
                    'su', 'meyve suyu', 'kola', 'ayran', 'gazoz', 'şarap', 'bira'
                ],
                '🧽 Temizlik & Hijyen': [
                    'deterjan', 'sabun', 'şampuan', 'diş macunu', 'çöp poşeti', 
                    'çöp torbası', 'temizlik bezi', 'tuvalet kağıdı', 'peçete'
                ]
            };
            
            const itemLower = item.toLowerCase();
            
            for (const [category, items] of Object.entries(categories)) {
                for (const keyword of items) {
                    if (itemLower.includes(keyword)) {
                        return category;
                    }
                }
            }
            return '📦 Diğer';
        }

        // Save to localStorage
        function saveToStorage() {
            localStorage.setItem('akilliMarket_shoppingList', JSON.stringify(appState.shoppingList));
            localStorage.setItem('akilliMarket_settings', JSON.stringify(appState.settings));
        }

        // Notification System
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.style.background = type === 'success' ? 'var(--card-background)' : '#FEE2E2';
            notification.style.color = type === 'success' ? 'var(--text-color)' : '#DC2626';
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // Update state and re-render
        function updateState(newState) {
            appState = { ...appState, ...newState };
            saveToStorage();
            render();
        }

        // Event handlers
        function handleLogin(username) {
            updateState({
                user: { 
                    name: username, 
                    id: Date.now(),
                    trustScore: 85
                }
            });
            showNotification(`Hoş geldin ${username}! 🎉`);
        }

        function addItem(name, quantity, unit) {
            const emoji = getProductEmoji(name);
            const displayQuantity = `${quantity} ${unit}`;
            
            const newShoppingItem = {
                id: Date.now() + Math.random(),
                name: name,
                quantity: displayQuantity,
                displayName: `${name} (${displayQuantity})`,
                emoji: emoji,
                completed: false,
                addedBy: appState.user?.name,
                category: categorizeItem(name),
                addedAt: new Date().toLocaleString('tr-TR')
            };
            
            updateState({
                shoppingList: [...appState.shoppingList, newShoppingItem],
                newItem: '',
                newQuantity: '1',
                newUnit: 'adet'
            });
            
            showNotification(`${emoji} ${name} (${displayQuantity}) listeye eklendi! ✅`);
        }

        function toggleItem(id) {
            const updatedList = appState.shoppingList.map(item => {
                if (String(item.id) === String(id)) {
                    return { ...item, completed: !item.completed };
                }
                return item;
            });
            
            updateState({ shoppingList: updatedList });
        }

        function deleteItemFromList(id) {
            const item = appState.shoppingList.find(item => String(item.id) === String(id));
            if (!item) {
                showNotification('Ürün bulunamadı!', 'error');
                return;
            }
            
            const updatedList = appState.shoppingList.filter(item => String(item.id) !== String(id));
            updateState({ shoppingList: updatedList });
            showNotification(`${item.emoji} ${item.name} alındı ve listeden silindi! ✅`);
        }

        function handleAiQuery() {
            const query = appState.aiQuery.toLowerCase().trim();
            
            if (!query) {
                showNotification('Lütfen bir yemek adı yazın!', 'error');
                return;
            }

            let found = false;
            for (const [mealName, mealData] of Object.entries(chefMealDatabase)) {
                if (query.includes(mealName) || mealName.includes(query)) {
                    updateState({
                        aiSuggestions: mealData.ingredients,
                        aiBotResponse: mealData.response
                    });
                    found = true;
                    break;
                }
            }

            if (!found) {
                const availableMeals = Object.keys(chefMealDatabase).slice(0, 10).join(', ') + '...';
                updateState({
                    aiSuggestions: [],
                    a
